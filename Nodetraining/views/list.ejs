<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="/main.css">
</head>

<body class="grey-bg">
    <%- include('nav.ejs')%>
        <div class="white-bg">
            <% for(let i=0; i < Í∏ÄÎ™©Î°ù.length; i++){ %>
                <div class="list-box">
                    <h4><a href="/detail/<%= Í∏ÄÎ™©Î°ù[i]._id %>">
                            <%= Í∏ÄÎ™©Î°ù[i].title %>
                        </a>
                        <a href="/edit/<%= Í∏ÄÎ™©Î°ù[i]._id %>">‚úèÔ∏è</a>
                        <span class="delete" data-id="<%= Í∏ÄÎ™©Î°ù[i]._id %>">üóëÔ∏è</span>
                    </h4>
                    <p>
                        <%= Í∏ÄÎ™©Î°ù[i].content %>
                    </p>
                </div>

                <% }%>
                <a href="/list/next/<%= Í∏ÄÎ™©Î°ù[Í∏ÄÎ™©Î°ù.length-1]._id %>">Îã§Ïùå</a>

                <script>
                    for (let i = 0; i < '<%= Í∏ÄÎ™©Î°ù.length %>'; i++) {
                        document.querySelectorAll('.delete')[i].addEventListener('click', function (e) {
                            console.log(e.target.dataset.id)
                            fetch('/delete?docid=' + e.target.dataset.id, {
                                method: 'DELETE'
                            })
                                .then((r) => r.text())
                                .then((r) => {
                                    console.log(r)
                                    e.target.parentElement.parentElement.style.display = 'none'
                                })
                        })
                    }
        
                </script>
        </div>

      
</body>

</html>